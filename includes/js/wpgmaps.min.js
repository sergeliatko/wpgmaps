document.addEventListener("DOMContentLoaded",function(){let infoWindow;let isHighDensity=function(){let minResolutionQuery="only screen and (min-resolution: 124dpi), only screen and (min-resolution: 1.3dppx), only screen and (min-resolution: 48.8dpcm)";let devicePixelRatioQuery="only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 1.3), only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (min-device-pixel-ratio: 1.3)";return((window.devicePixelRatio&&window.devicePixelRatio>1.3)||(window.matchMedia&&(window.matchMedia(minResolutionQuery).matches||window.matchMedia(devicePixelRatioQuery).matches)))};let getScale=function(){return isHighDensity()?"2":"1"};let loadStaticMap=function(a){let staticMap=a.querySelector(".wpgmap-static");let scale=getScale();let url=staticMap.getAttribute("data-url")+"&scale="+scale+"&size="+staticMap.clientWidth+"x"+staticMap.clientHeight;staticMap.style.backgroundImage="url("+url+")";staticMap.addEventListener("click",loadDynamicMap)};let translateLocation=function(a){return new google.maps.LatLng(parseFloat(a.latitude),parseFloat(a.longitude))};let getMapHorizontalPadding=function(a){return Math.round(a.clientWidth*0.05)};let getMapVerticalPadding=function(a){return Math.round(a.clientHeight*0.05)};let loadDynamicMap=function(){let mapContainer=this.parentNode;let mapKey=mapContainer.getAttribute("data-key");let mapData=wpgmaps.maps[mapKey];let loader=new google.maps.plugins.loader.Loader({apiKey:mapData.key,version:"weekly",id:"wpgmaps-dynamic-maps"});this.remove();loader.load().then(function(){if(undefined===infoWindow){infoWindow=new google.maps.InfoWindow()}let mapElement=document.createElement("div");mapElement.id=mapContainer.id+"-dynamic";mapElement.className="wpgmap-dynamic";mapContainer.appendChild(mapElement);let map=new google.maps.Map(mapElement,{});let bounds=new google.maps.LatLngBounds();mapData.pins.forEach(function(a){let marker=new google.maps.Marker({position:translateLocation(a.marker.location),title:a.marker.title,map:map});marker.infowindow=a.window;google.maps.event.addListener(marker,"click",(function(b){return function(){infoWindow.setContent(b.infowindow);infoWindow.open(b.map,b)}})(marker));bounds.extend(marker.position)});map.fitBounds(bounds,{bottom:getMapVerticalPadding(mapElement),left:getMapHorizontalPadding(mapElement),right:getMapHorizontalPadding(mapElement),top:getMapVerticalPadding(mapElement)});map.setCenter(bounds.getCenter());if(""!==mapData.zoom){let zoomHandler=google.maps.event.addListener(map,"idle",function(){map.setZoom(parseInt(mapData.zoom));google.maps.event.removeListener(zoomHandler)})}})};let loadMaps=function(){let maps=document.querySelectorAll("div.wpgmap");maps.forEach(loadStaticMap)};loadMaps()});